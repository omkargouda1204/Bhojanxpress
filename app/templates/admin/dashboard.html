{% extends "admin/base.html" %}

{% block title %}Admin Dashboard - BhojanXpress{% endblock %}

{% block content %}
<div class="container-fluid my-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="display-4">
                    <i class="fas fa-tachometer-alt text-primary"></i> Admin Dashboard
                </h1>
                <div class="text-muted">
                    Welcome back, {{ current_user.username or current_user.name }}!
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row mb-4">
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                Total Users
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ stats.total_users }}</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-users fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-success shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                Total Orders
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ stats.total_orders }}</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-shopping-cart fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                Food Items
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ stats.total_food_items }}</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-utensils fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-warning shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                Delivery Agents
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">
                                {{ stats.total_delivery_agents }}
                                <a href="{{ url_for('admin.delivery_agents') }}" class="text-decoration-none ms-2">
                                    <small><i class="fas fa-external-link-alt"></i></small>
                                </a>
                            </div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-motorcycle fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    

    <!-- Quick Actions -->
    <div class="row mb-4">
        <div class="col-lg-6">
            <div class="card shadow">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Quick Actions</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <a href="{{ url_for('admin.add_food') }}" class="btn btn-primary w-100">
                                <i class="fas fa-plus"></i> Add Food Item
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="{{ url_for('admin.orders', status='pending') }}" class="btn btn-warning w-100">
                                <i class="fas fa-clock"></i> Pending Orders
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="{{ url_for('admin.delivery_agents') }}" class="btn btn-dark w-100">
                                <i class="fas fa-motorcycle"></i> Delivery Agents
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="{{ url_for('admin.add_delivery_agent') }}" class="btn btn-secondary w-100">
                                <i class="fas fa-user-plus"></i> Add Delivery Agent
                            </a>
                        </div>
                        <div class="col-md-6 mb-3" >
                            <a href="{{ url_for('admin.manage_reviews') }}" class="btn btn-primary w-100" >
                                <i class="fas fa-star"></i> Manage Reviews
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="{{ url_for('admin.contact_messages') }}" class="btn btn-info w-100">
                                <i class="fas fa-envelope"></i> Contact Messages
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="{{ url_for('admin.reports') }}" class="btn btn-success w-100">
                                <i class="fas fa-chart-bar"></i> View Reports
                            </a>
                        </div>
                        <!-- <div class="col-md-6 mb-3">
                            <a href="#" class="btn btn-purple w-100" data-bs-toggle="modal" data-bs-target="#notificationModal">
                                <i class="fas fa-bell"></i> Notifications
                            </a>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-6">
            <div class="card shadow">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">Recent Orders</h6>
                </div>
                <div class="card-body">
                    {% if recent_orders %}
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Order ID</th>
                                        <th>Customer</th>
                                        <th>Amount</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for order in recent_orders %}
                                    <tr>
                                        <td><a href="{{ url_for('admin.order_details', order_id=order.id) }}">#{{ order.id }}</a></td>
                                        <td>{{ order.customer_name }}</td>
                                        <td>â‚¹{{ "%.2f"|format(order.total_amount) }}</td>
                                        <td>
                                            <span class="badge
                                                {% if order.status == 'pending' %}bg-warning{% endif %}
                                                {% if order.status == 'confirmed' %}bg-info{% endif %}
                                                {% if order.status == 'preparing' %}bg-primary{% endif %}
                                                {% if order.status == 'delivered' %}bg-success{% endif %}
                                                {% if order.status == 'cancelled' %}bg-danger{% endif %}
                                            ">
                                                {{ order.status|title }}
                                            </span>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <p class="text-muted">No recent orders found.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Notification Modal -->
<div class="modal fade" id="notificationModal" tabindex="-1" aria-labelledby="notificationModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="notificationModalLabel">
                    <i class="fas fa-bell"></i> Notifications
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-info">
                    <h6><i class="fas fa-info-circle"></i> Coming Soon!</h6>
                    <p class="mb-0">The notification system will include:</p>
                    <ul class="mt-2 mb-0">
                        <li>Order status updates</li>
                        <li>Review notifications when customers submit reviews</li>
                        <li>Admin reply notifications</li>
                        <li>Order-related messages</li>
                        <li>System alerts and updates</li>
                    </ul>
                </div>
                
                <!-- Placeholder for future notifications -->
                <div class="text-center text-muted py-3">
                    <i class="fas fa-bell-slash fa-3x mb-3"></i>
                    <p>No notifications at the moment</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.border-left-primary { border-left: 0.25rem solid #4e73df !important; }
.border-left-success { border-left: 0.25rem solid #1cc88a !important; }
.border-left-info { border-left: 0.25rem solid #36b9cc !important; }
.border-left-warning { border-left: 0.25rem solid #f6c23e !important; }
.text-gray-800 { color: #5a5c69 !important; }
.text-gray-300 { color: #dddfeb !important; }

.btn-primary {
  background-color: #28a745 !important; /* green */
  border-color: #28a745 !important;
}
.btn-primary:hover {
  background-color: #218838 !important;
  border-color: #1e7e34 !important;
}



/* Additional button colors */
.btn-orange {
    background-color: #dd7b2a;
    border-color: #fd7e14;
    color: rgb(140, 54, 131);
}
.btn-orange:hover {
    background-color: #197716;
    border-color: #e66300;
    color: rgb(70, 174, 41);
}

.btn-purple {
    background-color: #6f42c1;
    border-color: #6f42c1;
    color: white;
}
.btn-purple:hover {
    background-color: #5a2b9a;
    border-color: #5a2b9a;
    color: white;
}
.badge-pending { background-color: #f6c23e; }
.badge-confirmed { background-color: #36b9cc; }
.badge-preparing { background-color: #fd7e14; }
.badge-delivered { background-color: #1cc88a; }
.badge-cancelled { background-color: #e74a3b; }
</style>
{% endblock %}
